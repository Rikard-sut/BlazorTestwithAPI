@page "/realestates"
@using System.Net.Http.Json;
@inject HttpClient Http

<h3>RealEstates</h3>

@if (realEstates == null)
{
    <p>Loading.....</p>
}
else
{
    foreach (var estate in realEstates)
    {
        <div class="card">
            <h3>@estate.Title</h3>
            @if (estate.CanBeSold)
            {
                <p>Selling price: @estate.SellingPrice</p>
            }
            else
            {
                <p>Renting price : @estate.RentingPrice</p>
            }
        </div>
    }
}

@code {

    private RealEstate[] realEstates;

    protected override async Task OnInitializedAsync()
    {
        try
        {
            realEstates = await Http.GetFromJsonAsync<RealEstate[]>("api/RealEstates?skip=2&take=5");
        }
        catch (HttpRequestException)
        {
            Console.WriteLine("An error Occured");
        }
        catch (NotSupportedException)
        {
            Console.WriteLine("Content type is not supported");
        }
        catch (System.Text.Json.JsonException)
        {
            Console.WriteLine("Invalid Json");
        }
    }

    public class RealEstate
    {
        public int Id { get; set; }
        public string Title { get; set; }
        public int SellingPrice { get; set; }
        public int RentingPrice { get; set; }
        public bool CanBeSold { get; set; }
        public bool CanBeRented { get; set; }
    }

}
